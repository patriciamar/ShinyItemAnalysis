<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Conduct Parallel Analysis — fa_parallel • ShinyItemAnalysis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conduct Parallel Analysis — fa_parallel"><meta name="description" content="Computes the eigenvalues of the sample correlation matrix and the eigenvalues
obtained from a random correlation matrix for which no factors/components are
assumed. By default, the function utilizes a modified Horn's (1965) method,
which – instead of mean – uses 95th percentile of each item eigenvalues
sampling distribution as a threshold to find the optimal number of
factors/components."><meta property="og:description" content="Computes the eigenvalues of the sample correlation matrix and the eigenvalues
obtained from a random correlation matrix for which no factors/components are
assumed. By default, the function utilizes a modified Horn's (1965) method,
which – instead of mean – uses 95th percentile of each item eigenvalues
sampling distribution as a threshold to find the optimal number of
factors/components."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ShinyItemAnalysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/patriciamar/ShinyItemAnalysis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Conduct Parallel Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/patriciamar/ShinyItemAnalysis/blob/v1.5.5/R/fa_parallel.R" class="external-link"><code>R/fa_parallel.R</code></a></small>
      <div class="d-none name"><code>fa_parallel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the eigenvalues of the sample correlation matrix and the eigenvalues
obtained from a random correlation matrix for which no factors/components are
assumed. By default, the function utilizes a modified Horn's (1965) method,
which – instead of mean – uses 95th percentile of each item eigenvalues
sampling distribution as a threshold to find the optimal number of
factors/components.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fa_parallel</span><span class="op">(</span></span>
<span>  <span class="va">Data</span>,</span>
<span>  cor <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  n_obs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pca"</span>,</span>
<span>  threshold <span class="op">=</span> <span class="st">"quantile"</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_kaiser <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fm <span class="op">=</span> <span class="st">"minres"</span>,</span>
<span>  use <span class="op">=</span> <span class="st">"pairwise"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">Data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><em>data.frame</em> or <em>matrix</em>, dataset (where rows are
observations and columns items) or correlation matrix (recognized
automatically).</p></dd>


<dt id="arg-cor">cor<a class="anchor" aria-label="anchor" href="#arg-cor"></a></dt>
<dd><p><em>character</em>, how to calculate the correlation matrix of the
real data. Can be either <code>pearson</code> (default), <code>tetrachoric</code> or
<code>polychoric</code>. Unambiguous abbreviations accepted.</p></dd>


<dt id="arg-n-obs">n_obs<a class="anchor" aria-label="anchor" href="#arg-n-obs"></a></dt>
<dd><p><em>integer</em>, in case you provided the correlation matrix
directly as the input, you have to provide the number of observations in
the original dataset.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><em>character</em>, either <code>fa</code>, <code>pca</code>, or <code>both</code>
(the default). Which method to use for the eigenvalues simulation and
computation.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p><em>character</em>, whether to use traditionall Horn's method
or more recent and well-performing quantile one. Either <code>mean</code> or
<code>quantile</code> (default). Can be abbreviated.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p><em>numeric</em> (0–1), probability for which the sample quantile is
produced. Defaults to <code>.95</code>. Ignored if <code>threshold = "mean"</code>.</p></dd>


<dt id="arg-n-iter">n_iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p><em>integer</em>, number of iterations, i.e. the number of
zero-factor multivariate normal distributions to sample. Defaults to
<code>20</code>.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><em>logical</em>, if <code>TRUE</code> (the default), show the plot along
with the function results. To create the plot from the resulting object
afterwards, call <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p></dd>


<dt id="arg-show-kaiser">show_kaiser<a class="anchor" aria-label="anchor" href="#arg-show-kaiser"></a></dt>
<dd><p><em>logical</em>, whether to show Kaiser boundary in the
plot (the default) or not.</p></dd>


<dt id="arg-fm">fm<a class="anchor" aria-label="anchor" href="#arg-fm"></a></dt>
<dd><p><em>character</em>, factoring method. See <code><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">psych::fa()</a></code>
from the package <code><a href="https://rdrr.io/pkg/psych/man/00.psych-package.html" class="external-link">psych::psych()</a></code>.</p></dd>


<dt id="arg-use">use<a class="anchor" aria-label="anchor" href="#arg-use"></a></dt>
<dd><p>an optional character string giving a method for computing
covariances in the presence of missing values. This must be (an
abbreviation of) one of the strings "everything", "all.obs",
"complete.obs", "na.or.complete", or "pairwise.complete.obs".</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/psych/man/tetrachor.html" class="external-link">psych::polychoric</a></code></p><dl><dt><code>correct</code></dt>
<dd><p>Correction value to use to correct for continuity in the case of zero entry cell for tetrachoric, polychoric, polybi, and mixed.cor.  See the examples for the effect of correcting versus not correcting for continuity.</p></dd>

    <dt><code>smooth</code></dt>
<dd><p>if TRUE and if the tetrachoric/polychoric matrix is not positive definite, then apply a simple smoothing algorithm using cor.smooth</p></dd>

    <dt><code>global</code></dt>
<dd><p>When finding pairwise correlations, should we use the global values of the tau parameter (which is somewhat faster), or the local values (global=FALSE)?  The local option is equivalent to the polycor solution, or to doing one correlation at a time. global=TRUE borrows information for one item pair from the other pairs using those item's frequencies.   This will make a difference in the presence of lots of missing data. With very small sample sizes with global=FALSE and correct=TRUE, the function will fail (for as yet underdetermined reasons.</p></dd>

    <dt><code>weight</code></dt>
<dd><p>A vector of length of the number of observations that specifies the weights to apply to each case.  The NULL case is equivalent of weights of 1 for all cases.</p></dd>

    <dt><code>progress</code></dt>
<dd><p>Show the progress bar (if  not doing multicores)</p></dd>

    <dt><code>ML</code></dt>
<dd><p>ML=FALSE  do a quick two step procedure, ML=TRUE, do longer maximum likelihood — very slow! Deprecated</p></dd>

    <dt><code>delete</code></dt>
<dd><p>Cases with no variance are deleted with a warning before proceeding.</p></dd>

    <dt><code>max.cat</code></dt>
<dd><p>The maximum number of categories to bother with for polychoric.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>data.frame</code> and <code>sia_parallel</code>. Can be
plotted using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Horn proposed a solution to the problem of optimal factor number
identification using an approach based on a Monte Carlo simulation.</p>
<p>First, several (20 by default) zero-factor <code>p</code>-variate normal
distributions (where <code>p</code> is the number of columns) are obtained, and
<code>p</code> × <code>p</code> correlation matrices are computed for them. Eigenvalues
of each matrix is then calculated in order to get an eigenvalues sampling
distribution for each simulated variable.</p>
<p>Traditionally, Horn obtains an average of each sampling distribution and
these averages are used as a threshold which is compared with eigenvalues of
the original, real data. However, <em>usage of the mean was later disputed</em>
by Buja &amp; Eyuboglu (1992), and 95th percentile of eigenvalues sampling
distribution was suggested as a more accurate threshold. This, more recent
method is used by default in the function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Horn, J. L. (1965). A rationale and test for the number of factors in factor
analysis. Psychometrika, 30, 179–185. <a href="https://doi.org/10.1007/BF02289447" class="external-link">doi:10.1007/BF02289447</a></p>
<p>Buja, A., &amp; Eyuboglu, N. (1992). Remarks on parallel analysis. Multivariate
Behavioral Research, 27, 509–540. <a href="https://doi.org/10.1207/s15327906mbr2704_2" class="external-link">doi:10.1207/s15327906mbr2704_2</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jan Netik <br>
Institute of Computer Science of the Czech Academy of Sciences <br><a href="mailto:netik@cs.cas.cz">netik@cs.cas.cz</a></p>
<p>Patricia Martinkova <br>
Institute of Computer Science of the Czech Academy of Sciences <br><a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">fa_parallel</span><span class="op">(</span><span class="va">TestAnxietyCor</span>, n_obs <span class="op">=</span> <span class="fl">335</span>, method <span class="op">=</span> <span class="st">"pca"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input was recognized as a correlation matrix.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming 335 observations in the original data.</span>
<span class="r-plt img"><img src="fa_parallel-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> According to the parallel analysis, the optimal number of principal components is 1. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Following the Kaiser rule, 2 components are recommended.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"bfi"</span>, package <span class="op">=</span> <span class="st">"psych"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="va">bfi</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fa_parallel</span><span class="op">(</span><span class="va">items</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fa_parallel</span><span class="op">(</span><span class="va">items</span>, threshold <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="co"># traditional Horn's method</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patricia Martinkova, Adela Hladka, Jan Netik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

