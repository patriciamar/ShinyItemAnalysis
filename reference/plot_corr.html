<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute and plot an item correlation matrix — plot_corr • ShinyItemAnalysis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute and plot an item correlation matrix — plot_corr"><meta name="description" content='Computes and visualizes an item correlation matrix (also known as a heatmap),
offering several correlation "types" and optional clustering (with possible
cluster outlining). The function relies on ggplot2::ggplot(), providing a
high customisability using "the grammar of graphics" (see the examples
below).'><meta property="og:description" content='Computes and visualizes an item correlation matrix (also known as a heatmap),
offering several correlation "types" and optional clustering (with possible
cluster outlining). The function relies on ggplot2::ggplot(), providing a
high customisability using "the grammar of graphics" (see the examples
below).'><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ShinyItemAnalysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/patriciamar/ShinyItemAnalysis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Compute and plot an item correlation matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/patriciamar/ShinyItemAnalysis/blob/master/R/plot_corr.R" class="external-link"><code>R/plot_corr.R</code></a></small>
      <div class="d-none name"><code>plot_corr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes and visualizes an item correlation matrix (also known as a heatmap),
offering several correlation "types" and optional clustering (with possible
cluster outlining). The function relies on <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code>, providing a
high customisability using "the grammar of graphics" (see the examples
below).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_corr</span><span class="op">(</span></span>
<span>  <span class="va">Data</span>,</span>
<span>  cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"polychoric"</span>, <span class="st">"tetrachoric"</span>, <span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  clust_method <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  n_clust <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"circle"</span>, <span class="st">"square"</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  labels_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  line_size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  line_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  line_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  fill_alpha <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">Data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><code>matrix</code>, <code>data.frame</code> or <code>tibble</code>: either a
<code>data.frame</code> with scored items (as columns, one observation per row),
or a correlation matrix.</p></dd>


<dt id="arg-cor">cor<a class="anchor" aria-label="anchor" href="#arg-cor"></a></dt>
<dd><p>character: correlation "type" used to correlation matrix
computation; available options are <code>polychoric</code>, <code>tetrachoric</code>,
<code>pearson</code>, <code>spearman</code>, or <code>none</code> (in case you provide
the correlation matrix as <code>Data</code>).</p></dd>


<dt id="arg-clust-method">clust_method<a class="anchor" aria-label="anchor" href="#arg-clust-method"></a></dt>
<dd><p>character: optional clustering method, available options
are: <code>ward.D</code>, <code>ward.D2</code>, <code>single</code>, <code>complete</code>,
<code>average</code> (= UPGMA), <code>mcquitty</code> (= WPGMA), <code>median</code> (=
WPGMC), <code>centroid</code> (= UPGMC) or <code>none</code> (clustering disabled).
See <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust()</a></code> for a detailed description of available options.</p></dd>


<dt id="arg-n-clust">n_clust<a class="anchor" aria-label="anchor" href="#arg-n-clust"></a></dt>
<dd><p>integer: the number of clusters you want to be outlined. When
set to zero (the default), no cluster are outlined, but items still do get
sorted according to <code>clust_method</code> (if not set to <code>none</code>).</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>character: tile appearance; either <code>circle</code> (default) to
map the correlation coefficient to circle size and color, or <code>square</code>
to draw square-shaped tiles with only shade denoting the coefficient
magnitude. You can use an unambiguous abbreviation of the two.</p></dd>


<dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>logical: when <code>TRUE</code>, the correlation coefficients are
plotted onto tiles.</p></dd>


<dt id="arg-labels-size">labels_size<a class="anchor" aria-label="anchor" href="#arg-labels-size"></a></dt>
<dd><p>numeric: label size in points (pts).</p></dd>


<dt id="arg-line-size">line_size<a class="anchor" aria-label="anchor" href="#arg-line-size"></a></dt>
<dd><p>numeric: cluster outline width.</p></dd>


<dt id="arg-line-col">line_col<a class="anchor" aria-label="anchor" href="#arg-line-col"></a></dt>
<dd><p>character: color of the outline, either a HEX code (e.g.
"#123456"), or one of <code>R</code>'s standard colors (see the
<code><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors()</a></code>).</p></dd>


<dt id="arg-line-alpha">line_alpha<a class="anchor" aria-label="anchor" href="#arg-line-alpha"></a></dt>
<dd><p>numeric 0-1: the opacity of the outline.</p></dd>


<dt id="arg-fill">fill<a class="anchor" aria-label="anchor" href="#arg-fill"></a></dt>
<dd><p>character: the color used to fill the outlined clusters.</p></dd>


<dt id="arg-fill-alpha">fill_alpha<a class="anchor" aria-label="anchor" href="#arg-fill-alpha"></a></dt>
<dd><p>numeric 0–1: the opacity of the fill color.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/psych/man/tetrachor.html" class="external-link">psych::polychoric</a></code></p><dl><dt><code>correct</code></dt>
<dd><p>Correction value to use to correct for continuity in the case of zero entry cell for tetrachoric, polychoric, polybi, and mixed.cor.  See the examples for the effect of correcting versus not correcting for continuity.</p></dd>

    <dt><code>smooth</code></dt>
<dd><p>if TRUE and if the tetrachoric/polychoric matrix is not positive definite, then apply a simple smoothing algorithm using cor.smooth</p></dd>

    <dt><code>global</code></dt>
<dd><p>When finding pairwise correlations, should we use the global values of the tau parameter (which is somewhat faster), or the local values (global=FALSE)?  The local option is equivalent to the polycor solution, or to doing one correlation at a time. global=TRUE borrows information for one item pair from the other pairs using those item's frequencies.   This will make a difference in the presence of lots of missing data. With very small sample sizes with global=FALSE and correct=TRUE, the function will fail (for as yet underdetermined reasons.</p></dd>

    <dt><code>weight</code></dt>
<dd><p>A vector of length of the number of observations that specifies the weights to apply to each case.  The NULL case is equivalent of weights of 1 for all cases.</p></dd>

    <dt><code>std.err</code></dt>
<dd><p>std.err=FALSE does not report the standard errors (faster)  deprecated</p></dd>

    <dt><code>progress</code></dt>
<dd><p>Show the progress bar (if  not doing multicores)</p></dd>

    <dt><code>ML</code></dt>
<dd><p>ML=FALSE  do a quick two step procedure, ML=TRUE, do longer maximum likelihood — very slow! Deprecated</p></dd>

    <dt><code>delete</code></dt>
<dd><p>Cases with no variance are deleted with a warning before proceeding.</p></dd>

    <dt><code>max.cat</code></dt>
<dd><p>The maximum number of categories to bother with for polychoric.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>ggplot</code> and/or <code>gg</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Correlation heatmap displays selected type of correlations between items. The
color of tiles indicates how much and in which way the items are correlated
– red color means positive correlation and blue color means negative
correlation. Correlation heatmap can be reordered using hierarchical
clustering method specified with <code>clust_method</code> argument. When the desired
number of clusters (argument <code>n_clust</code>) is not zero and some clustering is
demanded, the rectangles outlining the found clusters are drawn.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jan Netik <br>
Institute of Computer Science of the Czech Academy of Sciences <br><a href="mailto:netik@cs.cas.cz">netik@cs.cas.cz</a></p>
<p>Patricia Martinkova <br>
Institute of Computer Science of the Czech Academy of Sciences <br><a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># use first 20 columns from HCI dataset (the remainder are not items)</span></span></span>
<span class="r-in"><span><span class="va">HCI</span> <span class="op">&lt;-</span> <span class="va">HCI</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use Pearson product-moment correlation coefficient for matrix computation</span></span></span>
<span class="r-in"><span><span class="fu">plot_corr</span><span class="op">(</span><span class="va">HCI</span>, cor <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_corr-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># use tetrachoric correlation and reorder the resulting heatmap</span></span></span>
<span class="r-in"><span><span class="co"># using Ward's method</span></span></span>
<span class="r-in"><span><span class="va">HCI</span> <span class="op">|&gt;</span> <span class="fu">plot_corr</span><span class="op">(</span>cor <span class="op">=</span> <span class="st">"tetrachoric"</span>, clust_method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># outline 3 Ward's clusters with bold yellow line and add labels</span></span></span>
<span class="r-in"><span><span class="va">HCI</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_corr</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_clust <span class="op">=</span> <span class="fl">3</span>, clust_method <span class="op">=</span> <span class="st">"ward.D2"</span>, line_col <span class="op">=</span> <span class="st">"yellow"</span>,</span></span>
<span class="r-in"><span>    line_size <span class="op">=</span> <span class="fl">1.5</span>, labels <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add title and position the legend below the plot</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">HCI</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_corr</span><span class="op">(</span>n_clust <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"HCI heatmap"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># mimic the look of corrplot package</span></span></span>
<span class="r-in"><span><span class="fu">plot_corr</span><span class="op">(</span><span class="va">HCI</span>, cor <span class="op">=</span> <span class="st">"polychoric"</span>, clust_method <span class="op">=</span> <span class="st">"complete"</span>, shape <span class="op">=</span> <span class="st">"square"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      barheight <span class="op">=</span> <span class="fl">.8</span>, barwidth <span class="op">=</span> <span class="fl">.0275</span>,</span></span>
<span class="r-in"><span>      default.unit <span class="op">=</span> <span class="st">"npc"</span>,</span></span>
<span class="r-in"><span>      title <span class="op">=</span> <span class="cn">NULL</span>, frame.colour <span class="op">=</span> <span class="st">"black"</span>, ticks.colour <span class="op">=</span> <span class="st">"black"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patricia Martinkova, Adela Hladka, Jan Netik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

